<% layout('layouts/boilerplate')%>

<!-- 引入样式文件 -->
<link rel="stylesheet" href="/styles/campground-form.css" />

<div class="container mt-5">
  <div class="row justify-content-center">
    <div class="col-lg-8 col-md-10">
      <div class="form-card">
        <h1 class="form-title text-center mb-4">Edit Campground</h1>

        <form
          action="/campgrounds/<%=campground._id%>?_method=PUT"
          method="POST"
          novalidate
          class="validated-form campground-form"
          enctype="multipart/form-data"
        >
          <div class="form-group">
            <label class="form-label" for="title">Title</label>
            <input
              class="form-control"
              type="text"
              id="title"
              name="campground[title]"
              value="<%=campground.title %>"
              placeholder="Enter campground title"
              required
            />
            <div class="valid-feedback">Looks good!</div>
            <div class="invalid-feedback">Please provide a title.</div>
          </div>

          <div class="form-group">
            <label class="form-label" for="location">Location</label>
            <input
              class="form-control"
              type="text"
              id="location"
              name="campground[location]"
              value="<%=campground.location %>"
              placeholder="Enter location"
              required
            />
            <div class="valid-feedback">Looks good!</div>
            <div class="invalid-feedback">Please provide a location.</div>
          </div>

          <div class="form-group">
            <label class="form-label" for="price">Campground Price</label>
            <div class="input-group">
              <span class="input-group-text">$</span>
              <input
                type="text"
                class="form-control"
                id="price"
                placeholder="0.00"
                name="campground[price]"
                value="<%=campground.price %>"
                required
              />
            </div>
            <div class="valid-feedback">Looks good!</div>
            <div class="invalid-feedback">Please provide a price.</div>
          </div>

          <div class="form-group">
            <label class="form-label" for="description">Description</label>
            <textarea
              class="form-control"
              id="description"
              name="campground[description]"
              rows="4"
              placeholder="Describe your campground..."
              required
            >
<%= campground.description%></textarea
            >
            <div class="valid-feedback">Looks good!</div>
            <div class="invalid-feedback">Please provide a description.</div>
          </div>

          <!-- 显示现有图片 -->
          <div class="form-group">
            <label class="form-label">Current Images</label>
            <div class="current-images">
              <% campground.image.forEach((img, i) => { %>
              <div class="image-item">
                <img
                  src="<%= img.url %>"
                  class="current-image"
                  alt="campground image"
                />
                <div class="image-actions">
                  <div class="form-check">
                    <input
                      class="form-check-input"
                      type="checkbox"
                      name="deleteImages[]"
                      value="<%= img.filename %>"
                      id="image-<%= i %>"
                    />
                    <label class="form-check-label" for="image-<%= i %>">
                      Delete this image
                    </label>
                  </div>
                </div>
              </div>
              <% }) %>
            </div>
          </div>

          <!-- 添加新图片 -->
          <div class="form-group">
            <label class="form-label" for="image">Add More Images</label>
            <input
              type="file"
              class="form-control"
              id="image"
              name="image"
              multiple
              accept="image/*"
            />
            <small class="form-text text-muted"
              >You can select multiple images at once</small
            >
          </div>

          <div class="form-actions">
            <button type="submit" class="btn btn-primary btn-submit">
              <i class="fas fa-save me-2"></i>Update Campground
            </button>
            <a
              href="/campgrounds/<%= campground._id%>"
              class="btn btn-secondary"
            >
              <i class="fas fa-arrow-left me-2"></i>Back to Campground
            </a>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>
